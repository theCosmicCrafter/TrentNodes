{
  "last_node_id": 14,
  "last_link_id": 18,
  "nodes": [
    {
      "id": 1,
      "type": "VHS_LoadVideo",
      "pos": [50, 50],
      "size": [300, 350],
      "flags": {},
      "order": 0,
      "mode": 0,
      "outputs": [
        {"name": "IMAGE", "type": "IMAGE", "links": [1, 5], "slot_index": 0},
        {"name": "frame_count", "type": "INT", "links": null},
        {"name": "audio", "type": "AUDIO", "links": [2], "slot_index": 2},
        {"name": "video_info", "type": "VHS_VIDEOINFO", "links": null}
      ],
      "properties": {"Node name for S&R": "VHS_LoadVideo"},
      "widgets_values": {
        "video": "",
        "force_rate": 24,
        "custom_width": 0,
        "custom_height": 0,
        "frame_load_cap": 0,
        "skip_first_frames": 0,
        "select_every_nth": 1,
        "format": "AnimateDiff"
      }
    },
    {
      "id": 2,
      "type": "LoadImagesFromFolderKJ",
      "pos": [50, 450],
      "size": [300, 200],
      "flags": {},
      "order": 1,
      "mode": 0,
      "outputs": [
        {"name": "image", "type": "IMAGE", "links": [3], "slot_index": 0},
        {"name": "mask", "type": "MASK", "links": null},
        {"name": "count", "type": "INT", "links": null},
        {"name": "image_path", "type": "STRING", "links": null}
      ],
      "properties": {"Node name for S&R": "LoadImagesFromFolderKJ"},
      "widgets_values": [
        "/path/to/mouth_shapes",
        512,
        512,
        "crop",
        9,
        0,
        false
      ],
      "title": "Load Mouth Shapes (A-H + X)"
    },
    {
      "id": 3,
      "type": "AudioToPhonemes",
      "pos": [400, 50],
      "size": [280, 100],
      "flags": {},
      "order": 2,
      "mode": 0,
      "inputs": [
        {"name": "audio", "type": "AUDIO", "link": 2}
      ],
      "outputs": [
        {"name": "phoneme_data", "type": "PHONEME_DATA", "links": [4], "slot_index": 0},
        {"name": "duration", "type": "FLOAT", "links": [6], "slot_index": 1}
      ],
      "properties": {"Node name for S&R": "AudioToPhonemes"},
      "widgets_values": ["small", "en"],
      "color": "#1a3a4a",
      "bgcolor": "#0d1f28"
    },
    {
      "id": 4,
      "type": "PhonemeToMouthShapes",
      "pos": [400, 200],
      "size": [280, 170],
      "flags": {},
      "order": 3,
      "mode": 0,
      "inputs": [
        {"name": "phoneme_data", "type": "PHONEME_DATA", "link": 4},
        {"name": "duration", "type": "FLOAT", "link": 6}
      ],
      "outputs": [
        {"name": "mouth_sequence", "type": "MOUTH_SEQUENCE", "links": [7], "slot_index": 0},
        {"name": "frame_count", "type": "INT", "links": null}
      ],
      "properties": {"Node name for S&R": "PhonemeToMouthShapes"},
      "widgets_values": [1, 24, "arpabet", 2, true],
      "color": "#1a3a4a",
      "bgcolor": "#0d1f28"
    },
    {
      "id": 5,
      "type": "MouthShapeLoader",
      "pos": [400, 450],
      "size": [280, 60],
      "flags": {},
      "order": 4,
      "mode": 0,
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 3}
      ],
      "outputs": [
        {"name": "mouth_shapes", "type": "IMAGE", "links": [8], "slot_index": 0}
      ],
      "properties": {"Node name for S&R": "MouthShapeLoader"},
      "widgets_values": [true],
      "color": "#1a3a4a",
      "bgcolor": "#0d1f28"
    },
    {
      "id": 6,
      "type": "RemoveMouthBackground",
      "pos": [400, 560],
      "size": [280, 150],
      "flags": {},
      "order": 5,
      "mode": 0,
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 8}
      ],
      "outputs": [
        {"name": "images", "type": "IMAGE", "links": [9], "slot_index": 0},
        {"name": "masks", "type": "MASK", "links": null}
      ],
      "properties": {"Node name for S&R": "RemoveMouthBackground"},
      "widgets_values": ["birefnet", "white", 0.15, 2, 2],
      "color": "#1a3a4a",
      "bgcolor": "#0d1f28"
    },
    {
      "id": 7,
      "type": "SAM3Segmentation",
      "pos": [750, 50],
      "size": [300, 150],
      "flags": {},
      "order": 6,
      "mode": 0,
      "inputs": [
        {"name": "image", "type": "IMAGE", "link": 5},
        {"name": "sam3_model", "type": "SAM3_MODEL", "link": 10}
      ],
      "outputs": [
        {"name": "mask", "type": "MASK", "links": [11], "slot_index": 0},
        {"name": "image", "type": "IMAGE", "links": null}
      ],
      "properties": {"Node name for S&R": "SAM3Segmentation"},
      "widgets_values": ["mouth", 0.5],
      "title": "SAM3 Track Mouth"
    },
    {
      "id": 8,
      "type": "LoadSAM3Model",
      "pos": [750, 250],
      "size": [250, 60],
      "flags": {},
      "order": 7,
      "mode": 0,
      "outputs": [
        {"name": "sam3_model", "type": "SAM3_MODEL", "links": [10], "slot_index": 0}
      ],
      "properties": {"Node name for S&R": "LoadSAM3Model"},
      "widgets_values": []
    },
    {
      "id": 9,
      "type": "MouthShapeCompositorTracked",
      "pos": [1100, 200],
      "size": [320, 280],
      "flags": {},
      "order": 8,
      "mode": 0,
      "inputs": [
        {"name": "frames", "type": "IMAGE", "link": 1},
        {"name": "mouth_shapes", "type": "IMAGE", "link": 9},
        {"name": "mouth_sequence", "type": "MOUTH_SEQUENCE", "link": 7},
        {"name": "tracking_masks", "type": "MASK", "link": 11}
      ],
      "outputs": [
        {"name": "frames", "type": "IMAGE", "links": [12], "slot_index": 0}
      ],
      "properties": {"Node name for S&R": "MouthShapeCompositorTracked"},
      "widgets_values": [true, "birefnet", "white", 1.0, 0, 0],
      "color": "#1a3a4a",
      "bgcolor": "#0d1f28",
      "title": "Tracked Compositor"
    },
    {
      "id": 10,
      "type": "VHS_VideoCombine",
      "pos": [1500, 200],
      "size": [250, 300],
      "flags": {},
      "order": 9,
      "mode": 0,
      "inputs": [
        {"name": "images", "type": "IMAGE", "link": 12},
        {"name": "audio", "type": "AUDIO", "link": 13}
      ],
      "outputs": [
        {"name": "Filenames", "type": "VHS_FILENAMES", "links": null}
      ],
      "properties": {"Node name for S&R": "VHS_VideoCombine"},
      "widgets_values": {
        "frame_rate": 24,
        "loop_count": 0,
        "filename_prefix": "lipsync_output",
        "format": "video/h264-mp4",
        "pingpong": false,
        "save_output": true
      }
    },
    {
      "id": 11,
      "type": "MouthShapePreview",
      "pos": [750, 400],
      "size": [280, 80],
      "flags": {},
      "order": 10,
      "mode": 0,
      "inputs": [
        {"name": "mouth_sequence", "type": "MOUTH_SEQUENCE", "link": 7}
      ],
      "outputs": [
        {"name": "preview", "type": "STRING", "links": null}
      ],
      "properties": {"Node name for S&R": "MouthShapePreview"},
      "widgets_values": [100],
      "color": "#1a3a4a",
      "bgcolor": "#0d1f28",
      "title": "Debug: Mouth Sequence"
    }
  ],
  "links": [
    [1, 1, 0, 9, 0, "IMAGE"],
    [2, 1, 2, 3, 0, "AUDIO"],
    [3, 2, 0, 5, 0, "IMAGE"],
    [4, 3, 0, 4, 0, "PHONEME_DATA"],
    [5, 1, 0, 7, 0, "IMAGE"],
    [6, 3, 1, 4, 1, "FLOAT"],
    [7, 4, 0, 9, 2, "MOUTH_SEQUENCE"],
    [8, 5, 0, 6, 0, "IMAGE"],
    [9, 6, 0, 9, 1, "IMAGE"],
    [10, 8, 0, 7, 1, "SAM3_MODEL"],
    [11, 7, 0, 9, 3, "MASK"],
    [12, 9, 0, 10, 0, "IMAGE"],
    [13, 1, 2, 10, 1, "AUDIO"]
  ],
  "groups": [
    {
      "title": "Audio Processing",
      "bounding": [380, 20, 320, 380],
      "color": "#3f789e"
    },
    {
      "title": "Mouth Shape Images",
      "bounding": [30, 420, 700, 320],
      "color": "#8aa54c"
    },
    {
      "title": "Mouth Tracking (SAM3)",
      "bounding": [730, 20, 340, 310],
      "color": "#a15c3e"
    },
    {
      "title": "Output",
      "bounding": [1080, 170, 700, 350],
      "color": "#6c5ce7"
    }
  ],
  "config": {},
  "extra": {
    "ds": {
      "scale": 0.8,
      "offset": [0, 0]
    }
  },
  "version": 0.4
}
